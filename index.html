<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SKYW LS 專項基金投資回報測算系統</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Microsoft JhengHei", "PingFang TC", "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            color: #2d3748;
            font-size: 28px;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header .subtitle {
            color: #718096;
            font-size: 14px;
            line-height: 1.6;
        }

        .main-content {
            display: grid;
            grid-template-columns: 400px 1fr;
            gap: 30px;
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .input-card {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            height: fit-content;
        }

        .input-card h2 {
            color: #2d3748;
            font-size: 20px;
            margin-bottom: 25px;
            font-weight: 600;
        }

        .input-group {
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            color: #4a5568;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 8px;
        }

        .input-group input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
        }

        .input-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .input-group .hint {
            color: #a0aec0;
            font-size: 12px;
            margin-top: 5px;
        }

        .button-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 30px;
        }

        .btn {
            padding: 14px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #edf2f7;
            color: #4a5568;
        }

        .btn-secondary:hover {
            background: #e2e8f0;
        }

        .results-area {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .result-card {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .result-card h3 {
            color: #2d3748;
            font-size: 18px;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .metric-item {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            color: white;
        }

        .metric-label {
            font-size: 13px;
            opacity: 0.9;
            margin-bottom: 8px;
        }

        .metric-value {
            font-size: 24px;
            font-weight: 700;
        }

        .breakdown-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        .breakdown-table th,
        .breakdown-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        .breakdown-table th {
            background: #f7fafc;
            color: #4a5568;
            font-weight: 600;
            font-size: 13px;
        }

        .breakdown-table td {
            color: #2d3748;
            font-size: 14px;
        }

        .breakdown-table tr:last-child td {
            border-bottom: none;
        }

        .amount-positive {
            color: #48bb78;
            font-weight: 600;
        }

        .amount-negative {
            color: #f56565;
            font-weight: 600;
        }

        .info-box {
            background: #ebf8ff;
            border-left: 4px solid #4299e1;
            padding: 16px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .info-box-title {
            color: #2c5282;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .info-box-content {
            color: #2d3748;
            font-size: 13px;
            line-height: 1.6;
        }

        .disclaimer {
            background: white;
            border-radius: 16px;
            padding: 25px;
            margin-top: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .disclaimer h3 {
            color: #2d3748;
            font-size: 16px;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .disclaimer p {
            color: #718096;
            font-size: 13px;
            line-height: 1.8;
            margin-bottom: 10px;
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            .btn {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>💎 SKYW LS 專項基金投資回報測算系統</h1>
            <p class="subtitle">
                本測算工具專為香港新能源數字資產上市公司成長基金設計，用於計算投資人在不同市值情景下的預期回報。
                採用標準化計算方法，考慮管理費、業績報酬、大宗轉讓折讓及香港稅收等因素。
            </p>
        </div>

        <div class="main-content">
            <div class="input-card">
                <h2>📊 投資參數設定</h2>
                
                <div class="input-group">
                    <label>初始投資金額（萬港元）</label>
                    <input type="number" id="investment" value="100" min="1" step="0.1">
                    <div class="hint">請輸入您的投資金額</div>
                </div>

                <div class="input-group">
                    <label>投資期限（年）</label>
                    <input type="number" id="years" value="2" min="0.5" max="10" step="0.5">
                    <div class="hint">基金預設期限為1+2年</div>
                </div>

                <div class="input-group">
                    <label>基金初始對應股票市值（億港元）</label>
                    <input type="number" id="initialMarketCap" value="2" min="0.1" step="0.1">
                    <div class="hint">基金設立時對應的股票總市值</div>
                </div>

                <div class="input-group">
                    <label>退出時股票市值（億港元）</label>
                    <input type="number" id="finalMarketCap" value="50" min="0.1" step="0.1">
                    <div class="hint">預期退出時的股票市值</div>
                </div>

                <div class="input-group">
                    <label>大宗轉讓折讓率（%）</label>
                    <input type="number" id="discount" value="10" min="0" max="50" step="1">
                    <div class="hint">退出時的大宗折讓，0表示無折讓</div>
                </div>

                <div class="input-group">
                    <label>投資者類型</label>
                    <select id="investorType" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 16px;">
                        <option value="individual">個人投資者（免資本利得稅）</option>
                        <option value="company_small">公司（首200萬利潤，8.25%）</option>
                        <option value="company_large">公司（超200萬利潤，16.5%）</option>
                    </select>
                    <div class="hint">香港資本利得稅適用規則</div>
                </div>

                <div class="button-group">
                    <button class="btn btn-primary" onclick="calculate()">💰 計算回報</button>
                    <button class="btn btn-secondary" onclick="window.print()">🖨️ 列印報告</button>
                </div>
            </div>

            <div class="results-area" id="resultsArea" style="display: none;">
                <div class="result-card">
                    <h3>📈 關鍵指標概覽</h3>
                    <div class="metrics-grid">
                        <div class="metric-item">
                            <div class="metric-label">基金淨值增長</div>
                            <div class="metric-value" id="navGrowth">--</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">投資倍數</div>
                            <div class="metric-value" id="multiple">--</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">最終到手金額</div>
                            <div class="metric-value" id="finalAmount">--</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">年化回報率</div>
                            <div class="metric-value" id="annualizedReturn">--</div>
                        </div>
                    </div>
                </div>

                <div class="result-card">
                    <h3>💎 情景一：無折讓退出</h3>
                    <table class="breakdown-table" id="scenario1"></table>
                </div>

                <div class="result-card">
                    <h3>📉 情景二：有折讓退出</h3>
                    <table class="breakdown-table" id="scenario2"></table>
                </div>

                <div class="result-card">
                    <h3>💼 業績報酬詳細拆解</h3>
                    <table class="breakdown-table" id="performanceFee"></table>
                </div>
            </div>
        </div>

        <div class="disclaimer">
            <h3>⚠️ 重要聲明</h3>
            <p>• 本計算器僅供參考，不構成任何投資建議或要約</p>
            <p>• 投資涉及風險，過往表現不代表未來回報</p>
            <p>• 實際回報可能因市場波動、政策變化等因素而有所不同</p>
            <p>• 稅務計算基於當前香港稅法，實際稅負請諮詢專業顧問</p>
            <p>• 本工具由香港卓高資產管理有限公司（SFC 9號牌照）提供，僅供內部使用</p>
        </div>
    </div>

    <script>
        function calculate() {
            // 獲取輸入值
            const investment = parseFloat(document.getElementById('investment').value);
            const years = parseFloat(document.getElementById('years').value);
            const initialMC = parseFloat(document.getElementById('initialMarketCap').value);
            const finalMC = parseFloat(document.getElementById('finalMarketCap').value);
            const discountRate = parseFloat(document.getElementById('discount').value) / 100;
            const investorType = document.getElementById('investorType').value;

            // 計算管理費（2%，前端扣除）
            const managementFee = investment * 0.02;
            const netInvestment = investment - managementFee;

            // 計算基金淨值變化
            const navMultiplier = finalMC / initialMC;
            const grossValue = netInvestment * navMultiplier;

            // 計算總收益率
            const totalReturn = (grossValue / investment - 1) * 100;

            // 情景一：無折讓
            const scenario1 = calculateScenario(investment, netInvestment, grossValue, grossValue, years, investorType, managementFee);
            
            // 情景二：有折讓
            const discountedValue = grossValue * (1 - discountRate);
            const scenario2 = calculateScenario(investment, netInvestment, grossValue, discountedValue, years, investorType, managementFee);

            // 顯示結果
            displayResults(scenario1, scenario2, navMultiplier, years, totalReturn);
        }

        function calculateScenario(investment, netInvestment, grossValue, actualValue, years, investorType, managementFee) {
            // 計算總收益
            const totalProfit = actualValue - investment;
            const returnRate = (actualValue / investment - 1) * 100;

            // 業績報酬計算（四檔累進）
            let performanceFee = 0;
            let tier1 = 0, tier2 = 0, tier3 = 0, tier4 = 0;

            // 計算年化收益率
            const annualizedRate = (Math.pow(actualValue / investment, 1 / years) - 1) * 100;

            // 第一檔：年化8%門檻
            const tier1Threshold = investment * Math.pow(1.08, years);
            if (actualValue > tier1Threshold) {
                tier1 = (Math.min(actualValue, investment * 2) - tier1Threshold) * 0;
            }

            // 第二檔：累計回報100%-200%（即2倍-3倍）
            if (actualValue > investment * 2) {
                const tier2Amount = Math.min(actualValue - investment * 2, investment);
                tier2 = tier2Amount * 0.20;
            }

            // 第三檔：累計回報200%-400%（即3倍-5倍）
            if (actualValue > investment * 3) {
                const tier3Amount = Math.min(actualValue - investment * 3, investment * 2);
                tier3 = tier3Amount * 0.40;
            }

            // 第四檔：累計回報>400%（即5倍以上）
            if (actualValue > investment * 5) {
                tier4 = (actualValue - investment * 5) * 0.50;
            }

            performanceFee = tier1 + tier2 + tier3 + tier4;

            // 扣除業績報酬後
            const afterPerformance = actualValue - performanceFee;

            // 計算稅收
            let tax = 0;
            const taxableGain = afterPerformance - investment;
            
            if (investorType === 'individual') {
                tax = 0; // 個人免資本利得稅
            } else if (investorType === 'company_small') {
                tax = Math.min(taxableGain, 200) * 0.0825; // 首200萬
            } else if (investorType === 'company_large') {
                if (taxableGain <= 200) {
                    tax = taxableGain * 0.0825;
                } else {
                    tax = 200 * 0.0825 + (taxableGain - 200) * 0.165;
                }
            }

            // 最終到手
            const finalAmount = afterPerformance - tax;

            // 實際年化回報
            const finalAnnualizedReturn = (Math.pow(finalAmount / investment, 1 / years) - 1) * 100;

            return {
                investment,
                managementFee,
                netInvestment,
                grossValue: actualValue,
                totalProfit,
                returnRate,
                performanceFee,
                tier1,
                tier2,
                tier3,
                tier4,
                afterPerformance,
                tax,
                finalAmount,
                annualizedRate,
                finalAnnualizedReturn
            };
        }

        function displayResults(s1, s2, navMultiplier, years, totalReturn) {
            document.getElementById('resultsArea').style.display = 'flex';

            // 關鍵指標
            document.getElementById('navGrowth').textContent = navMultiplier.toFixed(2) + 'x';
            document.getElementById('multiple').textContent = (s2.finalAmount / s2.investment).toFixed(2) + 'x';
            document.getElementById('finalAmount').textContent = s2.finalAmount.toFixed(2) + ' 萬';
            document.getElementById('annualizedReturn').textContent = s2.finalAnnualizedReturn.toFixed(2) + '%';

            // 情景一
            document.getElementById('scenario1').innerHTML = `
                <tr>
                    <th>項目</th>
                    <th style="text-align: right;">金額（萬港元）</th>
                    <th style="text-align: right;">說明</th>
                </tr>
                <tr>
                    <td>初始投資</td>
                    <td style="text-align: right;">${s1.investment.toFixed(2)}</td>
                    <td style="text-align: right;">投資人投入</td>
                </tr>
                <tr>
                    <td>管理費（2%）</td>
                    <td style="text-align: right;" class="amount-negative">-${s1.managementFee.toFixed(2)}</td>
                    <td style="text-align: right;">認購時扣除</td>
                </tr>
                <tr>
                    <td>實際運作金額</td>
                    <td style="text-align: right;">${s1.netInvestment.toFixed(2)}</td>
                    <td style="text-align: right;">進入基金運作</td>
                </tr>
                <tr>
                    <td>基金總資產</td>
                    <td style="text-align: right;" class="amount-positive">${s1.grossValue.toFixed(2)}</td>
                    <td style="text-align: right;">按市值計算</td>
                </tr>
                <tr>
                    <td>業績報酬</td>
                    <td style="text-align: right;" class="amount-negative">-${s1.performanceFee.toFixed(2)}</td>
                    <td style="text-align: right;">四檔累進</td>
                </tr>
                <tr>
                    <td>扣除業績報酬後</td>
                    <td style="text-align: right;">${s1.afterPerformance.toFixed(2)}</td>
                    <td style="text-align: right;">--</td>
                </tr>
                <tr>
                    <td>稅收</td>
                    <td style="text-align: right;" class="amount-negative">-${s1.tax.toFixed(2)}</td>
                    <td style="text-align: right;">依投資者類型</td>
                </tr>
                <tr style="font-weight: 700; background: #f7fafc;">
                    <td>最終到手金額</td>
                    <td style="text-align: right;" class="amount-positive">${s1.finalAmount.toFixed(2)}</td>
                    <td style="text-align: right;">${s1.finalAnnualizedReturn.toFixed(2)}% 年化</td>
                </tr>
            `;

            // 情景二
            document.getElementById('scenario2').innerHTML = `
                <tr>
                    <th>項目</th>
                    <th style="text-align: right;">金額（萬港元）</th>
                    <th style="text-align: right;">說明</th>
                </tr>
                <tr>
                    <td>初始投資</td>
                    <td style="text-align: right;">${s2.investment.toFixed(2)}</td>
                    <td style="text-align: right;">投資人投入</td>
                </tr>
                <tr>
                    <td>管理費（2%）</td>
                    <td style="text-align: right;" class="amount-negative">-${s2.managementFee.toFixed(2)}</td>
                    <td style="text-align: right;">認購時扣除</td>
                </tr>
                <tr>
                    <td>實際運作金額</td>
                    <td style="text-align: right;">${s2.netInvestment.toFixed(2)}</td>
                    <td style="text-align: right;">進入基金運作</td>
                </tr>
                <tr>
                    <td>折讓後價值</td>
                    <td style="text-align: right;">${s2.grossValue.toFixed(2)}</td>
                    <td style="text-align: right;">大宗轉讓折讓</td>
                </tr>
                <tr>
                    <td>業績報酬</td>
                    <td style="text-align: right;" class="amount-negative">-${s2.performanceFee.toFixed(2)}</td>
                    <td style="text-align: right;">四檔累進</td>
                </tr>
                <tr>
                    <td>扣除業績報酬後</td>
                    <td style="text-align: right;">${s2.afterPerformance.toFixed(2)}</td>
                    <td style="text-align: right;">--</td>
                </tr>
                <tr>
                    <td>稅收</td>
                    <td style="text-align: right;" class="amount-negative">-${s2.tax.toFixed(2)}</td>
                    <td style="text-align: right;">依投資者類型</td>
                </tr>
                <tr style="font-weight: 700; background: #f7fafc;">
                    <td>最終到手金額</td>
                    <td style="text-align: right;" class="amount-positive">${s2.finalAmount.toFixed(2)}</td>
                    <td style="text-align: right;">${s2.finalAnnualizedReturn.toFixed(2)}% 年化</td>
                </tr>
            `;

            // 業績報酬拆解
            document.getElementById('performanceFee').innerHTML = `
                <tr>
                    <th>檔次</th>
                    <th style="text-align: right;">回報範圍</th>
                    <th style="text-align: right;">管理人分成</th>
                    <th style="text-align: right;">金額（萬港元）</th>
                </tr>
                <tr>
                    <td>第一檔</td>
                    <td style="text-align: right;">0 - 年化8%</td>
                    <td style="text-align: right;">0%</td>
                    <td style="text-align: right;">${s2.tier1.toFixed(2)}</td>
                </tr>
                <tr>
                    <td>第二檔</td>
                    <td style="text-align: right;">年化8% - 2倍</td>
                    <td style="text-align: right;">20%</td>
                    <td style="text-align: right;">${s2.tier2.toFixed(2)}</td>
                </tr>
                <tr>
                    <td>第三檔</td>
                    <td style="text-align: right;">2倍 - 5倍</td>
                    <td style="text-align: right;">40%</td>
                    <td style="text-align: right;">${s2.tier3.toFixed(2)}</td>
                </tr>
                <tr>
                    <td>第四檔</td>
                    <td style="text-align: right;">> 5倍</td>
                    <td style="text-align: right;">50%</td>
                    <td style="text-align: right;">${s2.tier4.toFixed(2)}</td>
                </tr>
                <tr style="font-weight: 700; background: #f7fafc;">
                    <td colspan="3">總業績報酬</td>
                    <td style="text-align: right;" class="amount-negative">${s2.performanceFee.toFixed(2)}</td>
                </tr>
            `;

            // 滾動到結果區域
            document.getElementById('resultsArea').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
    </script>
</body>
</html>
